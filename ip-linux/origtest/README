This code is taken directly from the CN IP library by Leendert van Doorn. Only the IP addresses have been changed.

